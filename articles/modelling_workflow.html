<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Model Fitting and Post-Processing Workflow • IASDT.R</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model Fitting and Post-Processing Workflow">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IASDT.R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.03</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BioDT/IASDT.R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="modelling_workflow_files/kePrint-0.0.1/kePrint.js"></script><link href="modelling_workflow_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model Fitting and Post-Processing Workflow</h1>
                        <h4 data-toc-skip class="author">Ahmed
El-Gabbas</h4>
            
            <h4 data-toc-skip class="date">02 March, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/BioDT/IASDT.R/blob/main/vignettes/modelling_workflow.Rmd" class="external-link"><code>vignettes/modelling_workflow.Rmd</code></a></small>
      <div class="d-none name"><code>modelling_workflow.Rmd</code></div>
    </div>

    
    
<style type="text/css">
.ShortBlock {
height: 400px;
width: 100%;
}

summary {
color: blue;
padding-left: 40px;
}

ff {
  background-color: #def5ff;
  color: black;
  font-style: oblique;
}

cc {
  background-color: #f0f7eb;
  color: black;
  font-style: oblique;
}

</style>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This document outlines the workflow (currently under development) for
modelling the distribution and level of invasion (species richness) of
invasive alien plant species (IAS) in Europe. The IAS prototype Digital
Twin (<code>IAS-pDT</code>) is a component of the European project
<a href="https:/www.biodt.eu/" target="_blank">BioDT</a>, which aims to
develop a Digital Twin for biodiversity in Europe. For more information
on <code>IAS-pDT</code>, see
<a href="https://doi.org/10.3897/rio.10.e124579" target="_blank" class="external-link"><img src="https://img.shields.io/badge/10.3897/rio.10.e124579-blue" alt="DOI: 10.3897/rio.10.e124579"></a>.
The full workflow of the <code>IAS-pDT</code> can be found here
<a href="https://doi.org/10.5281/zenodo.14834385" target="_blank" class="external-link"><img src="https://img.shields.io/badge/10.5281/zenodo.14834385-blue" alt="DOI: 10.5281/zenodo.14834385"></a>.</p>
<p>The <code>IAS-pDT</code> utilizes the <code>IASDT.R</code> R package
(<a href="https://doi.org/10.5281/zenodo.14756907" target="_blank" class="external-link"><img src="https://img.shields.io/badge/10.5281/zenodo.14756907-blue" alt="DOI: 10.5281/zenodo.14756907"></a>)
to execute a workflow for model fitting, post-processing, and data
preparation for the
<a href="https://app.biodt.eu/app/biodtshiny" target="_blank" class="external-link">Shiny
app</a>. Model outputs from the <code>IAS-pDT</code> are publicly
accessible to end user and stakeholders via an
<a href="http://opendap.biodt.eu/ias-pdt/" target="_blank" class="external-link">OPeNDAP</a>
server, and prediction maps can be retrieved directly in R using the
<code>IASDT.R</code> package (currently in preparation).</p>
<p>Models are fitted using the Hierarchical Modelling of Species
Communities
(<a href="https://www.helsinki.fi/en/researchgroups/statistical-ecology/software/hmsc" target="_blank" class="external-link">Hmsc</a>)
R package. Due to the high computational cost of fitting these spatial
models at the European scale, we employ the <code>Hmsc-HPC</code>
extension
(<a href="https://doi.org/10.1371/journal.pcbi.1011914" target="_blank" class="external-link"><img src="https://img.shields.io/badge/10.1371/journal.pcbi.1011914-blue" alt="DOI: 10.1371/journal.pcbi.1011914"></a>)
to fit models on GPUs. Models are fitted at the habitat level, meaning
that a separate model is created for each habitat type, and only IAS
species associated with that habitat are included. We adopted the
habitat classification by Pyšek et
al. (<a href="https://doi.org/10.23855/preslia.2022.447" target="_blank" class="external-link"><img src="https://img.shields.io/badge/10.23855/preslia.2022.447-blue" alt="DOI: 10.23855/preslia.2022.447"></a>)
and fitted eight distinct models (see table below).</p>
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Abbreviation
</th>
<th style="text-align:left;">
Habitat Type
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Forests
</td>
<td style="text-align:left;">
closed vegetation dominated by deciduous or evergreen trees
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Open forests
</td>
<td style="text-align:left;">
woodlands with canopy openings created by environmental stress or
disturbance, including forest edges
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Scrub
</td>
<td style="text-align:left;">
shrublands maintained by environmental stress (aridity) or disturbance
</td>
</tr>
<tr>
<td style="text-align:left;">
4a
</td>
<td style="text-align:left;">
Natural grasslands
</td>
<td style="text-align:left;">
grasslands maintained by climate (aridity, unevenly distributed
precipitation), herbivores or environmental stress (aridity, instability
or toxicity of substrate)
</td>
</tr>
<tr>
<td style="text-align:left;">
4b
</td>
<td style="text-align:left;">
Human-maintained grasslands
</td>
<td style="text-align:left;">
grasslands dependent on regular human-induced management (mowing,
grazing by livestock, artificial burning)
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
Wetlands
</td>
<td style="text-align:left;">
sites with the permanent or seasonal influence of moisture, ranging from
oligotrophic to eutrophic
</td>
</tr>
<tr>
<td style="text-align:left;">
12a
</td>
<td style="text-align:left;">
Ruderal habitats
</td>
<td style="text-align:left;">
anthropogenically disturbed or eutrophicated sites, where the
anthropogenic disturbance orfertilization is typically a side-product
and not the aim of the management
</td>
</tr>
<tr>
<td style="text-align:left;">
12b
</td>
<td style="text-align:left;">
Agricultural habitats
</td>
<td style="text-align:left;">
synanthropic habitats directly associated with growing of agricultural
products, thus dependent on specific type of management (ploughing,
fertilization)
</td>
</tr>
</tbody>
</table>
<p>For each habitat type, predictions of individual species and species
richness are generated across multiple climate scenarios: five CMIP6
climate models × three Shared Socioeconomic Pathways (SSPs) × three
future time frames, totaling 45 scenarios (see CHELSA
<a href="https://chelsa-climate.org/wp-admin/download-page/CHELSA_tech_specification_V2.pdf" target="_blank" class="external-link">technical
specifications</a> for details). Additionally, we aggregate future
climate model outputs to provide an ensemble prediction for each SSP
scenario and time frame combination.</p>
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Climate model
</th>
<th style="text-align:left;">
Institution
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mpi-esm1-2-hr
</td>
<td style="text-align:left;">
Max Planck Institute for Meteorology, Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
ipsl-cm6a-lr
</td>
<td style="text-align:left;">
Institut Pierre Simon Laplace, France
</td>
</tr>
<tr>
<td style="text-align:left;">
ukesm1-0-ll
</td>
<td style="text-align:left;">
Met Office Hadley Centre, UK
</td>
</tr>
<tr>
<td style="text-align:left;">
gfdl-esm4
</td>
<td style="text-align:left;">
National Oceanic and Atmospheric Administration, USA
</td>
</tr>
<tr>
<td style="text-align:left;">
mri-esm2-0
</td>
<td style="text-align:left;">
Meteorological Research Institute, Japan
</td>
</tr>
</tbody>
</table>
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Shared Socioeconomic Pathway
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
ssp126
</td>
<td style="text-align:left;">
SSP1-RCP2.6 climate as simulated by the GCMs
</td>
</tr>
<tr>
<td style="text-align:left;">
ssp370
</td>
<td style="text-align:left;">
SSP3-RCP7 climate as simulated by the GCMs
</td>
</tr>
<tr>
<td style="text-align:left;">
ssp585
</td>
<td style="text-align:left;">
SSP5-RCP8.5 climate as simulated by the GCMs
</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="abiotic-predictors">Abiotic predictors<a class="anchor" aria-label="anchor" href="#abiotic-predictors"></a>
</h2>
<blockquote>
<p>Under preparation</p>
</blockquote>
<hr>
</div>
<div class="section level2">
<h2 id="species-distribution-data">Species-distribution data<a class="anchor" aria-label="anchor" href="#species-distribution-data"></a>
</h2>
<blockquote>
<p>Under preparation</p>
</blockquote>
<hr>
</div>
<div class="section level2">
<h2 id="model-input-data">Model input data<a class="anchor" aria-label="anchor" href="#model-input-data"></a>
</h2>
<p>The primary function for preparing model-fitting data and initial
models is <strong><code><a href="../reference/Mod_inputs.html">Mod_Prep4HPC()</a></code></strong>. It organizes
data for each habitat-specific model into separate directories (e.g.,
<ff>datasets/processed/model_fitting/HabX</ff>, where <i>X</i> denotes a
habitat type listed above). Internally, it invokes other functions for
specific tasks:</p>
<ul>
<li>
<code><a href="../reference/Mod_inputs.html">Mod_PrepData()</a></code>: prepare modelling input data. Important
arguments are:</li>
</ul>
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>Hab_Abb</cc>
</td>
<td style="text-align:left;">
abbreviation of a single habitat type to be modelled
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>Path_Model</cc>
</td>
<td style="text-align:left;">
directory path to where all model files will be saved
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>MinEffortsSp</cc>
</td>
<td style="text-align:left;">
minimum number of vascular plant species per grid cell required for
inclusion in model fitting. This represents the count of <em>all</em>
vascular plant species (including native ones) recorded in GBIF across
Europe. The count is calculated during the sampling effort preparation
step (<code><a href="../reference/Efforts_data.html">Efforts_Process()</a></code>). This argument helps exclude grid
cells with minimal sampling efforts
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>ExcludeCult</cc>
</td>
<td style="text-align:left;">
whether to exclude countries with cultivated or casual observations for
each species
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>ExcludeZeroHabitat</cc>
</td>
<td style="text-align:left;">
whether to exclude grid cells with zero habitat coverage of the
respective habitat type
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>PresPerSpecies</cc>
</td>
<td style="text-align:left;">
minimum number of presence grid cells for a species to be included in
the models. This is calculated after discarding grid cells with low
sampling efforts (<cc>MinEffortsSp</cc>), zero percentage habitat
coverage (<cc>ExcludeZeroHabitat</cc>), and countries with cultivated or
casual observations (<cc>ExcludeCult</cc>)
</td>
</tr>
</tbody></table>
<ul>
<li>
<code><a href="../reference/Mod_GetCV.html">Mod_GetCV()</a></code>: prepare and visualize spatial-block
cross-validation options:
<ul>
<li>
<i>CV_Dist</i>: the size of cross-validation blocks is determined by
the <cc>CV_NGrids</cc> argument</li>
<li>
<i>CV_Large</i>: the study area is split into large blocks, as
determined by the <cc>CV_NR</cc> and <cc>CV_NC</cc> arguments</li>
</ul>
</li>
</ul>
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>CV_NFolds</cc>
</td>
<td style="text-align:left;">
number of cross-validation folds
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>CV_NGrids</cc>
</td>
<td style="text-align:left;">
number of grid cells in both directions used in the <i>CV_Dist</i>
cross-validation strategy. The default value is 20, representing blocks
of 20×20 grid cell each
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>CV_NR</cc> / <br><cc>CV_NC</cc>
</td>
<td style="text-align:left;">
number of rows and columns used in the <i>CV_Large</i> cross-validation
strategy, in which the study area is divided into large blocks. if
<cc>CV_NR</cc> = <cc>CV_NC</cc> = 2 (default), will divide the study
area into four large blocks, split at the median coordinates
</td>
</tr>
</tbody></table>
<ul>
<li>
<code><a href="../reference/Mod_PrepKnots.html">Mod_PrepKnots()</a></code>: prepare and visualize knots for the
Gaussian Predictive Process (GPP) models
(<a href="https://doi.org/10.1371/10.1002/ecy.2929" target="_blank" class="external-link"><img src="https://img.shields.io/badge/10.1371/10.1002/ecy.2929-blue" alt="DOI: 10.1371/10.1002/ecy.2929"></a>)</li>
</ul>
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>GPP</cc>
</td>
<td style="text-align:left;">
whether to fit spatial random effect using GPP
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>GPP_Dists</cc>
</td>
<td style="text-align:left;">
distance in kilometers used both for the spacing between knots and the
minimum allowable distance between a knot and the nearest sampling point
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>GPP_Plot</cc>
</td>
<td style="text-align:left;">
whether to plot the coordinates of the sampling units and the knots
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>MinLF</cc> / <br><cc>MaxLF</cc>
</td>
<td style="text-align:left;">
minimum and maximum number of latent factors to be used
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>Alphapw</cc>
</td>
<td style="text-align:left;">
prior for the alpha parameter
</td>
</tr>
</tbody></table>
<ul>
<li>
<code><a href="../reference/Mod_SLURM.html">Mod_SLURM()</a></code>: prepare SLURM scripts for model fitting on
GPU using the <code>Hmsc-HPC</code> extension.</li>
</ul>
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>JobName</cc>
</td>
<td style="text-align:left;">
name of the job
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>ntasks</cc>
</td>
<td style="text-align:left;">
number of tasks
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>CpusPerTask</cc> / <br><cc>GpusPerNode</cc>
</td>
<td style="text-align:left;">
number of CPUs/GPUs per node
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>MemPerCpu</cc>
</td>
<td style="text-align:left;">
memory per CPU
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>Time</cc>
</td>
<td style="text-align:left;">
duration for which the job should run
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>Partition</cc>
</td>
<td style="text-align:left;">
HPC partition name
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<cc>NumArrayJobs</cc>
</td>
<td style="text-align:left;">
number of jobs per SLURM script
</td>
</tr>
</tbody></table>
<p>Other arguments are:</p>
<ul>
<li>selection of predictors:
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;">
<cc>BioVars<cc></cc></cc>
</td>
<td style="text-align:left;">
names of CHELSA variables to be used in the model
</td>
</tr>
<tr>
<td style="text-align:left;">
<cc>QuadraticVars<cc></cc></cc>
</td>
<td style="text-align:left;">
names of variables, for which quadratic terms are used
</td>
</tr>
<tr>
<td style="text-align:left;">
<cc>EffortsAsPredictor<cc></cc></cc>
</td>
<td style="text-align:left;">
whether to include the (log<sub>10</sub>) sampling efforts as predictor
</td>
</tr>
<tr>
<td style="text-align:left;">
<cc>RoadRailAsPredictor<cc></cc></cc>
</td>
<td style="text-align:left;">
whether to include the (log<sub>10</sub>) sum of road and railway
intensity as predictor
</td>
</tr>
<tr>
<td style="text-align:left;">
<cc>HabAsPredictor<cc></cc></cc>
</td>
<td style="text-align:left;">
whether to include the (log<sub>10</sub>) percentage coverage of
respective habitat type per grid cell as predictor
</td>
</tr>
<tr>
<td style="text-align:left;">
<cc>RiversAsPredictor<cc></cc></cc>
</td>
<td style="text-align:left;">
whether to include the (log<sub>10</sub>) total length of rivers per
grid cell as predictor
</td>
</tr>
</tbody></table>
</li>
<li>model fitting options
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;">
<cc>NChains</cc>
</td>
<td style="text-align:left;">
number of MCMC chains
</td>
</tr>
<tr>
<td style="text-align:left;">
<cc>thin</cc>
</td>
<td style="text-align:left;">
thinning value(s) in MCMC sampling
</td>
</tr>
<tr>
<td style="text-align:left;">
<cc>samples</cc>
</td>
<td style="text-align:left;">
number of MCMC samples per chain
</td>
</tr>
<tr>
<td style="text-align:left;">
<cc>transientFactor</cc>
</td>
<td style="text-align:left;">
transient multiplication factor. The value of transient will equal the
multiplication of transientFactor and thin
</td>
</tr>
<tr>
<td style="text-align:left;">
<cc>verbose</cc>
</td>
<td style="text-align:left;">
interval at which MCMC sampling progress is reported
</td>
</tr>
<tr>
<td style="text-align:left;">
<cc>Precision</cc>
</td>
<td style="text-align:left;">
floating-point precision mode for Hmsc-HPC sampling
</td>
</tr>
</tbody></table>
</li>
<li>
<cc>NspPerGrid</cc>: minimum number of IAS per grid cell for a grid
cell to be included in the analysis</li>
<li>
<cc>ModelCountry</cc>: fit the model for a specific country or
countries</li>
<li>whether or not to use phylogenetic trees: <cc>PhyloTree</cc> and
<cc>NoPhyloTree</cc>
</li>
<li>
<cc>Path_Hmsc</cc>: directory path to <code>Hmsc-HPC</code>
extension installation</li>
<li>
<cc>PrepSLURM</cc>: whether to prepare SLURM script for model
fitting on GPU via <code><a href="../reference/Mod_SLURM.html">Mod_SLURM()</a></code>
</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="model-fitting-on-gpus">Model fitting on GPUs<a class="anchor" aria-label="anchor" href="#model-fitting-on-gpus"></a>
</h2>
<p>Once the model input data and initial models are prepared, the next
step is model fitting on GPUs. For each habitat type, the
<code><a href="../reference/Mod_inputs.html">Mod_Prep4HPC()</a></code> function generates:</p>
<ul>
<li>python commands (<ff>Commands2Fit.txt</ff>) for fitting model chains
for all model variants on GPU (one line per chain)</li>
</ul>
<details><summary>
Example model fitting commands
</summary><div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 <span class="at">-m</span> hmsc.run_gibbs_sampler <span class="at">--input</span> <span class="st">'/pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Riv_Hab1/InitMod4HPC/InitMod_GPP120_Tree_samp1000_th200.rds'</span> <span class="at">--output</span> <span class="st">'/pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Riv_Hab1/Model_Fitting_HPC/GPP120_Tree_samp1000_th200_Chain1_post.rds'</span> <span class="at">--samples</span> 1000 <span class="at">--transient</span> 100000 <span class="at">--thin</span> 200 <span class="at">--verbose</span> 200 <span class="at">--chain</span> 0 <span class="at">--fp</span> 64 <span class="op">&gt;&amp;</span> <span class="st">'/pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Riv_Hab1/Model_Fitting_HPC/GPP120_Tree_samp1000_th200_Chain1_Progress.txt'</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 <span class="at">-m</span> hmsc.run_gibbs_sampler <span class="at">--input</span> <span class="st">'/pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Riv_Hab1/InitMod4HPC/InitMod_GPP120_Tree_samp1000_th200.rds'</span> <span class="at">--output</span> <span class="st">'/pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Riv_Hab1/Model_Fitting_HPC/GPP120_Tree_samp1000_th200_Chain2_post.rds'</span> <span class="at">--samples</span> 1000 <span class="at">--transient</span> 100000 <span class="at">--thin</span> 200 <span class="at">--verbose</span> 200 <span class="at">--chain</span> 1 <span class="at">--fp</span> 64 <span class="op">&gt;&amp;</span> <span class="st">'/pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Riv_Hab1/Model_Fitting_HPC/GPP120_Tree_samp1000_th200_Chain2_Progress.txt'</span></span></code></pre></div>
</details><ul>
<li>one or more SLURM script files (<ff>Bash_Fit.slurm</ff>) that can be
used to submit all model-fitting commands (<ff>Commands2Fit.txt</ff>) as
a batch job on an HPC system</li>
</ul>
<details><summary>
Example SLURM script
</summary><div class="sourceCode" id="cb2"><pre class="sourceCode bash ShortBlock"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># Job array configuration</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#SBATCH --job-name=Hab1</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#SBATCH --ntasks=1</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#SBATCH --output=datasets/processed/model_fitting/Mod_Riv_Hab1/Model_Fitting_HPC/JobsLog/%x-%A-%a.out</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#SBATCH --error=datasets/processed/model_fitting/Mod_Riv_Hab1/Model_Fitting_HPC/JobsLog/%x-%A-%a.out</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#SBATCH --account=project_465001588</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#SBATCH --cpus-per-task=1</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#SBATCH --mem-per-cpu=200G</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#SBATCH --gpus-per-node=1</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#SBATCH --time=3-00:00:00</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#SBATCH --partition=small-g</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#SBATCH --array=1-30</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co"># Job info</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Start time = </span><span class="va">$(</span><span class="fu">date</span><span class="va">)</span><span class="st">"</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Submitting directory = "</span><span class="va">$SLURM_SUBMIT_DIR</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"working directory = "</span><span class="va">$PWD</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Project name = "</span><span class="va">$SLURM_JOB_ACCOUNT</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Job id = "</span><span class="va">$SLURM_JOB_ID</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Job name = "</span><span class="va">$SLURM_JOB_NAME</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"memory per CPU = "</span><span class="va">$SLURM_MEM_PER_CPU</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"The GPU IDs of GPUs in the job allocation (if any) = "</span><span class="va">$SLURM_JOB_GPUS</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Node running the job script = "</span><span class="va">$SLURMD_NODENAME</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Process ID of the process started for the task = "</span><span class="va">$SLURM_TASK_PID</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Dependency = "</span><span class="va">$SLURM_JOB_DEPENDENCY</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Number of nodes assigned to a job = "</span><span class="va">$SLURM_NNODES</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Number of tasks requested by the job = "</span><span class="va">$SLURM_NTASKS</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Number of cpus per task = "</span><span class="va">$SLURM_CPUS_PER_TASK</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Number of tasks in the array = "</span><span class="va">$SLURM_ARRAY_TASK_COUNT</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Array's maximum ID (index) number = "</span><span class="va">$SLURM_ARRAY_TASK_MIN</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Array's minimum ID (index) number = "</span><span class="va">$SLURM_ARRAY_TASK_MAX</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a><span class="co"># File contains bash commands for model fitting</span></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a><span class="va">File</span><span class="op">=</span>datasets/processed/model_fitting/Mod_Riv_Hab1/Commands2Fit.txt</span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a><span class="co"># Loading Hmsc-HPC</span></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a><span class="bu">source</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/Hmsc_Simplified_OOM2/setup-env.sh</span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a><span class="co"># Check GPU</span></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a><span class="bu">export</span> <span class="va">TF_CPP_MIN_LOG_LEVEL</span><span class="op">=</span>3</span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a><span class="va">PythonCheckGPU</span><span class="op">=</span>references/LUMI_Check_GPU.py</span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a><span class="co"># Some checking</span></span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a><span class="va">Path_Python</span><span class="op">=</span><span class="va">$(</span><span class="fu">which</span> python3<span class="va">)</span></span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">"Some Checking:\n  &gt;&gt;  Working directory: </span><span class="va">$PWD</span><span class="st">\n  &gt;&gt;  Python path:       </span><span class="va">$Path_Python</span><span class="st">\n  &gt;&gt;  Checking GPU:      </span><span class="va">$(</span><span class="ex">python3</span> <span class="va">$PythonCheckGPU)</span><span class="st">\n"</span></span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a><span class="co"># Run array job</span></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a><span class="co"># -----------------------------------------------------------</span></span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a><span class="fu">head</span> <span class="at">-n</span> <span class="va">$SLURM_ARRAY_TASK_ID</span> <span class="va">$File</span> <span class="kw">|</span> <span class="fu">tail</span> <span class="at">-n</span> 1 <span class="kw">|</span> <span class="fu">bash</span></span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a></span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"End of program at </span><span class="kw">`</span><span class="fu">date</span><span class="kw">`</span><span class="st">"</span></span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a></span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a><span class="co"># |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a><span class="co"># |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a><span class="co"># This script was created on: 2025-02-13 19:43 CET</span></span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a><span class="co"># |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></span>
<span id="cb2-73"><a href="#cb2-73" tabindex="-1"></a><span class="co"># |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></span></code></pre></div>
</details><p>Batch job(s) for model fitting can be submitted using the
<code>sbatch</code> command; e.g. </p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">sbatch</span> datasets/processed/model_fitting/Hab1/Bash_Fit.slurm</span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="post-processing-of-fitted-models">Post-processing of fitted models<a class="anchor" aria-label="anchor" href="#post-processing-of-fitted-models"></a>
</h2>
<p>Post-processing of fitted models is carried out in multiple steps,
alternating computations between CPU and GPU.</p>
<div class="section level3">
<h3 id="step-1-cpu">Step 1: CPU<a class="anchor" aria-label="anchor" href="#step-1-cpu"></a>
</h3>
<p>The <strong><code><a href="../reference/Mod_postprocessing.html">Mod_Postprocess_1_CPU()</a></code></strong> function
serves as the initial post-processing step. For each habitat type, it
automates the following tasks:</p>
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Mod_SLURM.html">Mod_SLURM_Refit()</a></code>
</td>
<td style="text-align:left;">
check unsuccessful models
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Mod_Merge_Chains.html">Mod_Merge_Chains()</a></code>
</td>
<td style="text-align:left;">
merge MCMC chains and save fitted model and coda objects to <i>qs2</i>
or <i>RData</i> files
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Convergence_Plot_All.html">Convergence_Plot_All()</a></code>
</td>
<td style="text-align:left;">
visualize convergence of the <code>rho</code>, <code>alpha</code>,
<code>omega</code>, and <code>beta</code> parameters across all fitted
model variants. This function is unnecessary if only one model variant
is used. It compares convergence for models fitted with e.g., multiple
thinning values, both with and without phylogenetic relationships, or
with varying distances between GPP knots
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Convergence_plots.html">Convergence_Plot()</a></code>
</td>
<td style="text-align:left;">
visualize model convergence of the <code>rho</code>, <code>alpha</code>,
<code>omega</code>, and <code>beta</code> parameters of the selected
model. This is similar to <code>Convergence_Plot_All</code>, but
providing detailed overview of the convergence of a single selected
model
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/PlotGelman.html">PlotGelman()</a></code>
</td>
<td style="text-align:left;">
visualize Gelman-Rubin-Brooks diagnostics of the selected model
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Mod_Summary.html">Mod_Summary()</a></code>
</td>
<td style="text-align:left;">
extract and save model summary
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Parameter_Heatmap.html">Mod_Heatmap_Beta()</a></code>
</td>
<td style="text-align:left;">
plotting <code>beta</code> parameters as heatmaps
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Parameter_Heatmap.html">Mod_Heatmap_Omega()</a></code>
</td>
<td style="text-align:left;">
plotting the <code>omega</code> parameter (residual associations) as
heatmaps
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Mod_CV_Fit.html">Mod_CV_Fit()</a></code>
</td>
<td style="text-align:left;">
prepare input data for model fitting on spatial-block cross-validation
</td>
</tr>
</tbody></table>
<p>Previous attempts to prepare response curve data, predict at new
sites, and compute variance partitioning failed when using R and CPU on
the UFZ Windows server and LUMI HPC. Consequently, these data are
prepared on GPUs. <code><a href="../reference/Mod_postprocessing.html">Mod_Postprocess_1_CPU()</a></code> function invokes
the following functions:</p>
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Response_curves.html">RespCurv_PrepData()</a></code>
</td>
<td style="text-align:left;">
predict latent factors for response curves
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Predict_Maps.html">Predict_Maps()</a></code>
</td>
<td style="text-align:left;">
predict latent factors at new sampling units
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Variance_partitioning.html">VarPar_Compute()</a></code>
</td>
<td style="text-align:left;">
compute variance partitioning
</td>
</tr>
</tbody></table>
<p><br>Following running <code><a href="../reference/Mod_postprocessing.html">Mod_Postprocess_1_CPU()</a></code> for all
habitat types, the <strong><code><a href="../reference/Mod_postprocessing.html">Mod_Prep_TF()</a></code></strong> function
prepares batch scripts for GPU computations of <em>all</em> habitat
types: predicting latent factor predictions for response curves and new
sampling units and for computing variance partitioning.</p>
<ul>
<li>predict latent factors
<ul>
<li>
<code><a href="../reference/Response_curves.html">RespCurv_PrepData()</a></code> inherits the core functionalities
of <code><a href="https://rdrr.io/pkg/Hmsc/man/constructGradient.html" class="external-link">Hmsc::constructGradient()</a></code> and
<code><a href="https://rdrr.io/pkg/Hmsc/man/plotGradient.html" class="external-link">Hmsc::plotGradient()</a></code>, while adding capabilities to prepare
data for response curves on GPUs [<cc>LF_Commands_Only = TRUE</cc>]. To
predict at the mean coordinate (see <i>coordinates</i> argument of
<code><a href="https://rdrr.io/pkg/Hmsc/man/constructGradient.html" class="external-link">Hmsc::constructGradient()</a></code>), latent factor predictions must
be computed at that coordinate, a memory-intensive task using
<code><a href="https://rdrr.io/pkg/Hmsc/man/predictLatentFactor.html" class="external-link">Hmsc::predictLatentFactor()</a></code>. The function exports execution
commands to <ff>LF_RC_Commands_*.txt</ff> files(s) on the main
directory, along with many <i>*.qs2</i> and <i>*.feather</i> data files
in the <ff>TEMP_Pred</ff> directory.</li>
<li>Similarly, <code><a href="../reference/Predict_Maps.html">Predict_Maps()</a></code> [<cc>LF_Only = TRUE,
LF_Commands_Only = TRUE</cc>] exports execution commands to
<ff>LF_NewSites_Commands_*.txt</ff> files(s) on the main directory,
along with many <i>*.qs2</i> and <i>*.feather</i> data files in the
<ff>TEMP_Pred</ff> directory.</li>
<li>
<code><a href="../reference/Mod_postprocessing.html">Mod_Prep_TF()</a></code> matches all files with the pattern
<cc>^LF_NewSites_Commands_.+.txt|^LF_RC_Commands_.+txt</cc> (both for
response curves and latent factor predictions) and split their contents
into multiple scripts at the <ff>TF_postprocess</ff> directory for
processing as a batch job. The function prepares a SLURM script for
latent factor predictions (<ff>LF_SLURM.slurm</ff>).</li>
</ul>
</li>
</ul>
<details><summary>
Example <ff>LF_SLURM.slurm</ff> file
</summary><div class="sourceCode" id="cb4"><pre class="sourceCode bash ShortBlock"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#SBATCH --job-name=PP_LF</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#SBATCH --ntasks=1</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#SBATCH --ntasks-per-node=1</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#SBATCH --account=project_465001588</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#SBATCH --cpus-per-task=1</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#SBATCH --mem-per-cpu=200G</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#SBATCH --gpus-per-node=1</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#SBATCH --time=01:00:00</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#SBATCH --partition=small-g</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#SBATCH --output=datasets/processed/model_fitting/TMP/%x-%A-%a.out</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#SBATCH --error=datasets/processed/model_fitting/TMP/%x-%A-%a.out</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#SBATCH --array=1-186</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co"># Define directories</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="va">OutputDir</span><span class="op">=</span><span class="st">"datasets/processed/model_fitting/TF_BatchFiles"</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co"># Find all the split files and sort them explicitly</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="va">SplitFiles</span><span class="op">=</span><span class="va">($(</span><span class="fu">find</span> <span class="st">"</span><span class="va">$OutputDir</span><span class="st">"</span> <span class="at">-type</span> f <span class="at">-name</span> <span class="st">"TF_Chunk_*.txt"</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-V</span><span class="va">))</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co"># Check if files were found</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">${</span><span class="op">#</span><span class="va">SplitFiles</span><span class="op">[@]</span><span class="va">}</span> <span class="ot">-eq</span> 0 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"Error: No files matching TF_Chunk_*.txt found in </span><span class="va">$OutputDir</span><span class="st">"</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co"># Ensure no more than `, NumFiles, ` files are processed</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="va">MaxFiles</span><span class="op">=</span>186</span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">${</span><span class="op">#</span><span class="va">SplitFiles</span><span class="op">[@]</span><span class="va">}</span> <span class="ot">-gt</span> <span class="va">$MaxFiles</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>    <span class="va">SplitFiles</span><span class="op">=</span><span class="va">(</span><span class="st">"</span><span class="va">${SplitFiles</span><span class="op">[@]:</span><span class="dv">0</span><span class="op">:</span><span class="va">$MaxFiles}</span><span class="st">"</span><span class="va">)</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"More than </span><span class="va">$MaxFiles</span><span class="st"> files found, limiting to the first </span><span class="va">$MaxFiles</span><span class="st"> files."</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co"># Get the index of the current task based on SLURM_ARRAY_TASK_ID</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="va">TaskIndex</span><span class="op">=</span><span class="va">$((SLURM_ARRAY_TASK_ID</span> <span class="op">-</span> <span class="dv">1</span><span class="va">))</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a><span class="co"># Validate TaskIndex</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$TaskIndex</span> <span class="ot">-ge</span> <span class="va">${</span><span class="op">#</span><span class="va">SplitFiles</span><span class="op">[@]</span><span class="va">}</span> <span class="bu">]</span> <span class="kw">||</span> <span class="bu">[</span> <span class="va">$TaskIndex</span> <span class="ot">-lt</span> 0 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"Error: TaskIndex </span><span class="va">$TaskIndex</span><span class="st"> is out of range. Valid range: 0 to </span><span class="va">$((${</span><span class="op">#</span><span class="va">SplitFiles</span><span class="op">[@]</span><span class="va">}</span> <span class="op">-</span> <span class="dv">1</span><span class="va">))</span><span class="st">"</span></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a><span class="co"># Get the specific split file to process based on the job array task ID</span></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a><span class="va">SplitFile</span><span class="op">=</span><span class="st">"</span><span class="va">${SplitFiles</span><span class="op">[</span><span class="va">$TaskIndex</span><span class="op">]</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a><span class="co"># Verify the selected split file</span></span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">"</span><span class="va">$SplitFile</span><span class="st">"</span> <span class="bu">]</span> <span class="kw">||</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-f</span> <span class="st">"</span><span class="va">$SplitFile</span><span class="st">"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"Error: File </span><span class="va">$SplitFile</span><span class="st"> does not exist or is invalid."</span></span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a></span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a><span class="co"># Processing file</span></span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Processing file: </span><span class="va">$SplitFile</span><span class="st">"</span></span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a></span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a><span class="co"># Run the selected split file</span></span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a><span class="fu">bash</span> <span class="st">"</span><span class="va">$SplitFile</span><span class="st">"</span></span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a></span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a><span class="bu">echo</span> End of program at <span class="kw">`</span><span class="fu">date</span><span class="kw">`</span></span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a></span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a><span class="co"># This script was created on: 2024-12-13 02:23 CET</span></span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span></code></pre></div>
</details><ul>
<li>
<code><a href="../reference/Variance_partitioning.html">VarPar_Compute()</a></code> function exports files for processing
variance partitioning on GPU to the <ff>TEMP_VP</ff> directory:
<ff>VP_A_Command.txt</ff>, <ff>VP_F_Command.txt</ff>,
<ff>VP_mu_Command.txt</ff>, and <ff>VP_SLURM.slurm</ff>.
<code><a href="../reference/Mod_postprocessing.html">Mod_Prep_TF()</a></code> scans for files matching the pattern
<cc>VP_.+Command.txt</cc> for different habitat types and consolidates
them into a single file (<ff>TF_postprocess/VP_Commands.txt</ff>). Then,
it prepares a SLURM script, <ff>TF_postprocess/VP_SLURM.slurm</ff>, for
variance partitioning computations.</li>
</ul>
<details><summary>
Example <ff>Example_VP_Commands.txt</ff> file
</summary><div class="sourceCode" id="cb5"><pre class="sourceCode bash ShortBlock"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_gemu.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_Tr.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_Mu.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_Mu.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_gemu.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_Tr.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_Mu.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_Mu.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_gemu.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_Tr.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_Mu.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_Mu.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_gemu.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_Tr.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_Mu.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_Mu.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_gemu.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_Tr.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_Mu.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_Mu.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_gemu.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_Tr.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_Mu.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_Mu.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_gemu.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_Tr.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_Mu.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_Mu.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_gemu.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_Tr.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_Mu.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_Mu.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_geta.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_Tr.feather <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_X.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_A.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_A.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_geta.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_Tr.feather <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_X.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_A.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_A.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_geta.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_Tr.feather <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_X.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_A.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_A.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_geta.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_Tr.feather <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_X.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_A.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_A.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_geta.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_Tr.feather <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_X.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_A.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_A.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_geta.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_Tr.feather <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_X.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_A.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_A.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_geta.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_Tr.feather <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_X.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_A.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_A.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_geta.py <span class="at">--tr</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_Tr.feather <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_X.feather <span class="at">--gamma</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_Gamma.feather <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_A.feather <span class="at">--ncores</span> 3 <span class="at">--chunk_size</span> 50 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_A.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_getf.py <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_X.feather <span class="at">--beta_dir</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_F.feather <span class="at">--ncores</span> 3 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab1/TEMP_VP/VP_F.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_getf.py <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_X.feather <span class="at">--beta_dir</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_F.feather <span class="at">--ncores</span> 3 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab2/TEMP_VP/VP_F.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_getf.py <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_X.feather <span class="at">--beta_dir</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_F.feather <span class="at">--ncores</span> 3 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab3/TEMP_VP/VP_F.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_getf.py <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_X.feather <span class="at">--beta_dir</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_F.feather <span class="at">--ncores</span> 3 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab4a/TEMP_VP/VP_F.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_getf.py <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_X.feather <span class="at">--beta_dir</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_F.feather <span class="at">--ncores</span> 3 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab4b/TEMP_VP/VP_F.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_getf.py <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_X.feather <span class="at">--beta_dir</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_F.feather <span class="at">--ncores</span> 3 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab10/TEMP_VP/VP_F.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_getf.py <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_X.feather <span class="at">--beta_dir</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_F.feather <span class="at">--ncores</span> 3 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab12a/TEMP_VP/VP_F.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="ex">/usr/bin/time</span> <span class="at">-v</span> python3 /pfs/lustrep4/scratch/project_465000915/elgabbas/renv/library/linux-sles-15.5/R-4.4/x86_64-pc-linux-gnu/IASDT.R/VP_getf.py <span class="at">--x</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_X.feather <span class="at">--beta_dir</span> /pfs/lustrep4/scratch/project_465000915/elgabbas/datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP <span class="at">--output</span> datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_F.feather <span class="at">--ncores</span> 3 <span class="op">&gt;&gt;</span> datasets/processed/model_fitting/Mod_Q_Hab12b/TEMP_VP/VP_F.log <span class="dv">2</span><span class="op">&gt;&amp;</span><span class="dv">1</span></span></code></pre></div>
</details><details><summary>
Example <ff>VP_SLURM.slurm</ff> file
</summary><div class="sourceCode" id="cb6"><pre class="sourceCode bash ShortBlock"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#SBATCH --job-name=VP_TF</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#SBATCH --ntasks=1</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#SBATCH --ntasks-per-node=1</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#SBATCH --account=project_465001588</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#SBATCH --cpus-per-task=1</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#SBATCH --mem-per-cpu=200G</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#SBATCH --gpus-per-node=1</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#SBATCH --time=01:30:00</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#SBATCH --partition=small-g</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#SBATCH --output=datasets/processed/model_fitting/TMP/%x-%A-%a.out</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#SBATCH --error=datasets/processed/model_fitting/TMP/%x-%A-%a.out</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#SBATCH --array=1-24</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co"># File containing commands to be executed</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="va">File</span><span class="op">=</span>datasets/processed/model_fitting/VP_Commands.txt</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co"># Load TensorFlow module and configure environment</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="ex">ml</span> use /appl/local/csc/modulefiles</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="ex">ml</span> tensorflow</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="bu">export</span> <span class="va">TF_CPP_MIN_LOG_LEVEL</span><span class="op">=</span>3</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="bu">export</span> <span class="va">TF_ENABLE_ONEDNN_OPTS</span><span class="op">=</span>0</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co"># Verify GPU availability</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-c</span> <span class="st">"import tensorflow as tf; print(</span><span class="dt">\"</span><span class="st">Num GPUs Available:</span><span class="dt">\"</span><span class="st">, len(tf.config.list_physical_devices(</span><span class="dt">\"</span><span class="st">GPU</span><span class="dt">\"</span><span class="st">)))"</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co"># Run array job</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="fu">head</span> <span class="at">-n</span> <span class="va">$SLURM_ARRAY_TASK_ID</span> <span class="va">$File</span> <span class="kw">|</span> <span class="fu">tail</span> <span class="at">-n</span> 1 <span class="kw">|</span> <span class="fu">bash</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="bu">echo</span> End of program at <span class="kw">`</span><span class="fu">date</span><span class="kw">`</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co"># This script was created on: 2024-12-13 02:23 CET</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span></code></pre></div>
</details><p><br></p>
<hr>
</div>
<div class="section level3">
<h3 id="step-2-gpu">Step 2: GPU<a class="anchor" aria-label="anchor" href="#step-2-gpu"></a>
</h3>
<ul>
<li>Computations for latent factor predictions and variance partitioning
are performed on GPUs. Batch jobs can be submitted using the
<code>sbatch</code> command.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">sbatch</span> datasets/processed/model_fitting/TF_postprocess/VP_SLURM.slurm</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">sbatch</span> datasets/processed/model_fitting/TF_postprocess/LF_SLURM.slurm</span></code></pre></div>
<ul>
<li>cross-validated models are fitted by submitting respective SLURM
commands — [In preparation]</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="bu">source</span> datasets/processed/model_fitting/HabX/Model_Fitting_CV/CV_Bash_Fit.slurm</span></code></pre></div>
<hr>
<p><br></p>
</div>
<div class="section level3">
<h3 id="step-3-cpu">Step 3: CPU<a class="anchor" aria-label="anchor" href="#step-3-cpu"></a>
</h3>
<p>The <strong><code><a href="../reference/Mod_postprocessing.html">Mod_Postprocess_2_CPU()</a></code></strong> function
continues the analysis pipeline for post-processing Hmsc models on the
CPU. It automates the following tasks:</p>
<table class="table table table-condensed table-hover" style="font-size: 16px; margin-left: auto; margin-right: auto;"><tbody>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Response_curves.html">RespCurv_PrepData()</a></code>,<br><code><a href="../reference/Response_curves.html">RespCurv_PlotSR()</a></code>,<br><code><a href="../reference/Response_curves.html">RespCurv_PlotSp()</a></code>,<br><code><a href="../reference/Response_curves.html">RespCurv_PlotSpAll()</a></code>
</td>
<td style="text-align:left;">
process and visualize response curves
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Predict_Maps.html">Predict_Maps()</a></code>
</td>
<td style="text-align:left;">
<ul>
<li>predict habitat suitability across different climate options</li>
<li>compute model internal evaluation (explanatory power)</li>
<li>prepare maps for the shiny app
</li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Mod_Predict_Plot.html">Mod_Predict_Plot()</a></code>
</td>
<td style="text-align:left;">
visualize species &amp; species richness predictions as JPEG
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Mod_Plot_LF.html">Mod_Plot_LF()</a></code>
</td>
<td style="text-align:left;">
visualize spatial variation in site loadings of HMSC Models as JPEG
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Variance_partitioning.html">VarPar_Compute()</a></code>,<br><code><a href="../reference/Variance_partitioning.html">VarPar_Plot()</a></code>
</td>
<td style="text-align:left;">
process and visualize variance partitioning
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/Mod_Eval_Plot.html">Mod_Eval_Plot()</a></code>
</td>
<td style="text-align:left;">
visualize model internal evaluation (explanatory power)
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>In preparation...</code>
</td>
<td style="text-align:left;">
initiate post-processing of fitted cross-validated models and prepare
commands for latent factor predictions on GPU
</td>
</tr>
</tbody></table>
<hr>
</div>
<div class="section level3">
<h3 id="step-4-gpu">Step 4: GPU<a class="anchor" aria-label="anchor" href="#step-4-gpu"></a>
</h3>
<p>Predicting latent factors for cross-validated models on GPUs — [In
preparation]</p>
<hr>
</div>
<div class="section level3">
<h3 id="step-5-cpu">Step 5: CPU<a class="anchor" aria-label="anchor" href="#step-5-cpu"></a>
</h3>
<p>Evaluating model performance for cross-validated models — [In
preparation]</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://elgabbas.netlify.app/" class="external-link">Ahmed El-Gabbas</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
