% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mod_ssdm_fit.R
\name{fit_sdm_models}
\alias{fit_sdm_models}
\title{Species Distribution Modelling Workflow for Single-Species Models}
\usage{
fit_sdm_models(
  sdm_method = NULL,
  model_settings = NULL,
  model_dir = NULL,
  hab_abb = NULL,
  cv_type = "cv_dist",
  n_cores = 8L,
  n_cores_check = 8L,
  n_cores_summary = 8L,
  strategy = "multisession",
  future_max_size = 2000L,
  selected_species = NULL,
  excluded_species = NULL,
  env_file = ".env",
  clamp_pred = TRUE,
  fix_efforts = "q90",
  fix_rivers = "q90",
  climate_models = "all",
  climate_scenarios = "all",
  climate_periods = "all",
  copy_maxent_html = TRUE
)
}
\arguments{
\item{sdm_method}{Character. A single SDM algorithm to use for fitting
models. Valid values: "glm", "glmpoly", "gam", "glmnet", "mars", "gbm",
"rf", "ranger", "cart", "rpart", "maxent", "mlp", "rbf", "svm", "mda", and
"fda". These correspond to selected methods supported by the \code{sdm} package.
For details and supported options, see \code{\link[sdm:add]{sdm::getmethodNames()}}.}

\item{model_settings}{List or NULL. List of model-specific settings. If
\code{NULL}, defaults to custom settings defined within the workflow.}

\item{model_dir}{Character. Path to the directory containing model data and
where outputs and results will be saved. Model data are prepared using the
\code{\link[=mod_prepare_hpc]{mod_prepare_hpc()}} and \code{\link[=mod_prepare_data]{mod_prepare_data()}} functions.}

\item{hab_abb}{Character. Abbreviation for a single SynHab habitat type.
Valid values: "0", "1", "2", "3", "4a", "4b", "10", "12a", "12b". See
\code{\link[=mod_prepare_hpc]{mod_prepare_hpc()}} for more details.}

\item{cv_type}{Character. Cross-validation type. One of \code{cv_dist} (default)
or \code{cv_large}. See \code{\link[=mod_cv_fit]{mod_cv_fit()}} for more details.}

\item{n_cores, n_cores_check, n_cores_summary}{Integer. Number of CPU cores for
parallel processing of model fitting, model checking, and summarising model
outputs. Default is 8.}

\item{strategy}{Character. The parallel processing strategy to use. Valid
options are "sequential", "multisession" (default), "multicore", and
"cluster". See \code{\link[future:plan]{future::plan()}} and \code{\link[ecokit:set_parallel]{ecokit::set_parallel()}} for details.}

\item{future_max_size}{Numeric. Maximum allowed total size (in megabytes) of
global variables identified. See \code{\link[ecokit:set_parallel]{ecokit::set_parallel()}} and
\code{future.globals.maxSize} argument of \code{\link[future:zzz-future.options]{future::future.options()}} for more
details.}

\item{selected_species, excluded_species}{Character vector or NULL. Names of
species to include or exclude for modelling.}

\item{env_file}{Character. Path to a file with environment variable
definitions for spatial datasets. Default is \code{".env"}.}

\item{clamp_pred}{Logical. Should clamping be applied to sampling efforts and
river length predictors for prediction? Default is \code{TRUE}.}

\item{fix_efforts, fix_rivers}{Character or numeric (length 1). Method or
fixed value for sampling effort and river length (both at log-scale) when
clamping is enabled (\code{clamp_pred = TRUE}). Valid methods: "identity" (use
observed, with no clamping), summary statistics for the sampling efforts
layer ("median", "mean", "max", or "q90" (default; 90th percentile)), or a
single numeric value within observed range.}

\item{climate_models}{Character vector or "all". Which climate change models
to use for future projections. Valid values (case-sensitive): "GFDL-ESM4",
"IPSL-CM6A-LR", "MPI-ESM1-2-HR", "MRI-ESM2-0", "UKESM1-0-LL", or "all"
(default, meaning all available models). If a subset, must be a subset of
the listed valid models.}

\item{climate_scenarios}{Character vector or "all". Which climate change
scenarios to use for future projections. Valid values: "ssp126", "ssp370",
"ssp585", or "all" (default, meaning all available scenarios). If a subset,
must be a subset of the listed valid scenarios.}

\item{climate_periods}{Character vector or "all". Time periods for
prediction. Valid values are "2011-2040", "2041-2070", "2071-2100", or
"all" (default), or subset of supported periods.}

\item{copy_maxent_html}{Logical. Whether to copy the directory containing
HTML results from Maxent to the modelling directory. Default is \code{TRUE}.}
}
\value{
A tibble summarizing model results for each species, including:
\itemize{
\item Evaluation metrics for training and testing data (AUC, TSS, Kappa, etc.)
\item Variable importance scores
\item Response curves for each environmental variable
\item Prediction summaries for current and future climate scenarios
\item Paths to generated model files and prediction rasters
}

Additionally, the function saves various outputs to disk for future use:
\itemize{
\item Fitted model objects (as .RData files)
\item Extracted model information (evaluation metrics, variable importance,
etc.)
\item Prediction rasters for each species, cross-validation fold, and climate
scenario
\item Summary statistics across CV folds (mean, weighted mean, SD, and
coefficient of variation)
\item Species richness maps for each climate scenario
}
}
\description{
This comprehensive workflow implements single-species species distribution
models (sSDMs) for invasive alien plant species in Europe at the habitat
level. It orchestrates the entire process from data preparation to model
fitting, evaluation, and prediction across current and future climate
scenarios. The workflow employs the \code{sdm} R package for model fitting and
handles cross-validation, parallel processing, and various environmental
predictors.
}
\details{
The \code{fit_sdm_models} function orchestrates a comprehensive workflow
that handles all aspects of single-species distribution modelling for
invasive alien plant species in Europe. The workflow integrates several
internal components that manage different stages of the modelling process:

\strong{Overall workflow:}
\itemize{
\item \emph{Input validation}: Checks all parameters for validity
\item \emph{Data preparation}: Loads and processes model data
\item \emph{Parallel processing setup}: Configures computational resources
\item \emph{Model fitting and prediction}: For each species and CV fold
\item \emph{Results summarization}: Compiles metrics, variable importance, and
predictions
\item \emph{Species richness calculation}: Across all modelled species
}

\strong{Core capabilities:}
\itemize{
\item \emph{Data preparation}: The workflow validates and prepares necessary
input data including modelling data, environmental predictors, and
prediction datasets. It handles species selection, data loading, and
preprocessing of spatial predictors (including clamping of sampling efforts
and river length when required).
\item \emph{Model parameterization}: The function provides carefully selected
default settings for various SDM algorithms, ensuring consistent
parameterization across models.
\item \emph{Model information extraction}: After fitting, the workflow
automatically extracts key information from fitted SDM objects, including
evaluation metrics, variable importance, and response curves.
\item \emph{Model optimization}: Technical improvements like optimizing SDM model
object size by setting formula environments to the base environment address
known issues in the sdm package.
\item \emph{Parallel prediction}: The workflow efficiently generates predictions
for each species and cross-validation fold, handling model fitting,
information extraction, prediction, and file saving in parallel.
\item \emph{Statistical summarization}: Summary statistics are calculated across
cross-validation folds, including mean, weighted mean (by test AUC),
standard deviation, and coefficient of variation of predictions.
}
}
\author{
Ahmed El-Gabbas
}
