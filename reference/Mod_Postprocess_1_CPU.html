<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model pipeline for Hmsc analysis (using CPU) — Mod_Postprocess_1_CPU • IASDT.R</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model pipeline for Hmsc analysis (using CPU) — Mod_Postprocess_1_CPU"><meta name="description" content="This function sets up and runs an analysis pipeline for Hmsc models. It
includes steps for environment setup, loading packages, managing SLURM
refits, merging MCMC chains, convergence diagnostics, model summaries, and
prepare input commands to use TensorFlow on GPU for compute variance
partitioning and predicting latent factor for new spatial locations and
response curves. This function must be followed by Mod_Prep_TF to prepare
GPU-based TensorFlow batch scripts for variance partitioning and latent
factor prediction."><meta property="og:description" content="This function sets up and runs an analysis pipeline for Hmsc models. It
includes steps for environment setup, loading packages, managing SLURM
refits, merging MCMC chains, convergence diagnostics, model summaries, and
prepare input commands to use TensorFlow on GPU for compute variance
partitioning and predicting latent factor for new spatial locations and
response curves. This function must be followed by Mod_Prep_TF to prepare
GPU-based TensorFlow batch scripts for variance partitioning and latent
factor prediction."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IASDT.R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.02</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BioDT/IASDT.R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model pipeline for Hmsc analysis (using CPU)</h1>
      <small class="dont-index">Source: <a href="https://github.com/BioDT/IASDT.R/blob/main/R/Mod_Postprocess.R" class="external-link"><code>R/Mod_Postprocess.R</code></a></small>
      <div class="d-none name"><code>Mod_Postprocess_1_CPU.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function sets up and runs an analysis pipeline for Hmsc models. It
includes steps for environment setup, loading packages, managing SLURM
refits, merging MCMC chains, convergence diagnostics, model summaries, and
prepare input commands to use TensorFlow on GPU for compute variance
partitioning and predicting latent factor for new spatial locations and
response curves. This function must be followed by <a href="Mod_Prep_TF.html">Mod_Prep_TF</a> to prepare
GPU-based TensorFlow batch scripts for variance partitioning and latent
factor prediction.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Mod_Postprocess_1_CPU</span><span class="op">(</span></span>
<span>  ModelDir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Hab_Abb <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  NCores <span class="op">=</span> <span class="fl">8L</span>,</span>
<span>  FromHPC <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  EnvFile <span class="op">=</span> <span class="st">".env"</span>,</span>
<span>  Path_Hmsc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  MemPerCpu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  FromJSON <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  GPP_Dist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Tree <span class="op">=</span> <span class="st">"Tree"</span>,</span>
<span>  Samples <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  Thin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  NOmega <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  CVName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CV_Dist"</span>, <span class="st">"CV_Large"</span><span class="op">)</span>,</span>
<span>  N_Grid <span class="op">=</span> <span class="fl">50L</span>,</span>
<span>  UseTF <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  TF_use_single <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  LF_NCores <span class="op">=</span> <span class="va">NCores</span>,</span>
<span>  LF_Temp_Cleanup <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  LF_Check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  Temp_Cleanup <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  TF_Environ <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Pred_Clamp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Fix_Efforts <span class="op">=</span> <span class="st">"q90"</span>,</span>
<span>  Pred_NewSites <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  NCores_VP <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-modeldir">ModelDir<a class="anchor" aria-label="anchor" href="#arg-modeldir"></a></dt>
<dd><p>String. Path to the root directory of the fitted models
without the trailing slash. Two folders will be created <code>Model_Fitted</code> and
<code>Model_Coda</code> to store merged model and coda objects, respectively.</p></dd>


<dt id="arg-hab-abb">Hab_Abb<a class="anchor" aria-label="anchor" href="#arg-hab-abb"></a></dt>
<dd><p>Character. Habitat abbreviation indicating the specific
<a href="https://www.preslia.cz/article/pdf?id=11548" class="external-link">SynHab</a> habitat type for
which data will be prepared. Valid values are <code>0</code>, <code>1</code>, <code>2</code>, <code>3</code>, <code>4a</code>,
<code>4b</code>, <code>10</code>, <code>12a</code>, <code>12b</code>. For more details, see <a href="https://doi.org/10.23855/preslia.2022.447" class="external-link">Pysek et al.</a>.</p></dd>


<dt id="arg-ncores">NCores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>Integer specifying the number of parallel cores for
parallelization. Default: 8 cores.</p></dd>


<dt id="arg-fromhpc">FromHPC<a class="anchor" aria-label="anchor" href="#arg-fromhpc"></a></dt>
<dd><p>Logical indicating whether the work is being done from HPC, to
adjust file paths accordingly. Default: <code>TRUE</code>.</p></dd>


<dt id="arg-envfile">EnvFile<a class="anchor" aria-label="anchor" href="#arg-envfile"></a></dt>
<dd><p>Character. Path to the environment file containing paths to
data sources. Defaults to <code>.env</code>.</p></dd>


<dt id="arg-path-hmsc">Path_Hmsc<a class="anchor" aria-label="anchor" href="#arg-path-hmsc"></a></dt>
<dd><p>String. Path for the Hmsc-HPC.</p></dd>


<dt id="arg-mempercpu">MemPerCpu<a class="anchor" aria-label="anchor" href="#arg-mempercpu"></a></dt>
<dd><p>String. Memory per CPU allocation for the SLURM job.
Example: <code>32G</code> for 32 gigabytes. Defaults to <code>NULL</code>. If not provided, the
function will throw an error.</p></dd>


<dt id="arg-time">Time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>String. Duration for which the job should run. Example:
<code>01:00:00</code> for one hour. If not provided, the function will throw an error.</p></dd>


<dt id="arg-fromjson">FromJSON<a class="anchor" aria-label="anchor" href="#arg-fromjson"></a></dt>
<dd><p>Logical. Indicates whether to convert loaded models from JSON
format before reading. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-gpp-dist">GPP_Dist<a class="anchor" aria-label="anchor" href="#arg-gpp-dist"></a></dt>
<dd><p>Integer specifying the distance in <em>kilometers</em> between knots
for GPP models.</p></dd>


<dt id="arg-tree">Tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>Character string specifying if phylogenetic tree was used in the
model. Valid values are "Tree" or "NoTree". Default is "Tree".</p></dd>


<dt id="arg-samples">Samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>Integer specifying the value for the number of MCMC samples in
the selected model. Defaults to 1000.</p></dd>


<dt id="arg-thin">Thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>Integer specifying the value for thinning in the selected model.</p></dd>


<dt id="arg-nomega">NOmega<a class="anchor" aria-label="anchor" href="#arg-nomega"></a></dt>
<dd><p>An integer specifying the number of species to be sampled for
the <code>Omega</code> parameter transformation. Defaults to 100.</p></dd>


<dt id="arg-cvname">CVName<a class="anchor" aria-label="anchor" href="#arg-cvname"></a></dt>
<dd><p>Character vector specifying the name of the column(s) in the
model input data (see <a href="Mod_PrepData.html">Mod_PrepData</a> and <a href="GetCV.html">GetCV</a>) to be
used to cross-validate the models. The function allows the possibility of
using more than one way of assigning grid cells into cross-validation
folders. If multiple names are provided, separate cross-validation models
will be fitted for each column. Currently, there are three cross-validation
strategies, created using the <a href="Mod_PrepData.html">Mod_PrepData</a>: <code>CV_SAC</code>, <code>CV_Dist</code>,
and <code>CV_Large</code> (see <a href="GetCV.html">GetCV</a>).</p></dd>


<dt id="arg-n-grid">N_Grid<a class="anchor" aria-label="anchor" href="#arg-n-grid"></a></dt>
<dd><p>Integer specifying the number of points along the gradient for
continuous focal variables. Defaults to 50. See <a href="https://rdrr.io/pkg/Hmsc/man/constructGradient.html" class="external-link">Hmsc::constructGradient</a>
for more details.</p></dd>


<dt id="arg-usetf">UseTF<a class="anchor" aria-label="anchor" href="#arg-usetf"></a></dt>
<dd><p>Logical indicating whether to use TensorFlow for calculations.
Defaults to TRUE.</p></dd>


<dt id="arg-tf-use-single">TF_use_single<a class="anchor" aria-label="anchor" href="#arg-tf-use-single"></a></dt>
<dd><p>Logical indicating whether to use single precision for
the TF calculations. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-lf-ncores">LF_NCores<a class="anchor" aria-label="anchor" href="#arg-lf-ncores"></a></dt>
<dd><p>Integer specifying the number of cores to use for parallel
processing. Defaults to 8.</p></dd>


<dt id="arg-lf-temp-cleanup">LF_Temp_Cleanup<a class="anchor" aria-label="anchor" href="#arg-lf-temp-cleanup"></a></dt>
<dd><p>Logical indicating whether to delete temporary files
in the <code>Temp_Dir</code> after finishing the LF predictions.</p></dd>


<dt id="arg-lf-check">LF_Check<a class="anchor" aria-label="anchor" href="#arg-lf-check"></a></dt>
<dd><p>Logical. If TRUE, the function checks if the output files are
already created and valid. If FALSE, the function will only check if the
files exist without checking their integrity. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-temp-cleanup">Temp_Cleanup<a class="anchor" aria-label="anchor" href="#arg-temp-cleanup"></a></dt>
<dd><p>logical, indicating whether to clean up temporary files.
Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-tf-environ">TF_Environ<a class="anchor" aria-label="anchor" href="#arg-tf-environ"></a></dt>
<dd><p>Character string specifying the path to the Python
environment. Defaults to NULL. This argument is required if <code>UseTF</code> is
TRUE.</p></dd>


<dt id="arg-pred-clamp">Pred_Clamp<a class="anchor" aria-label="anchor" href="#arg-pred-clamp"></a></dt>
<dd><p>Logical indicating whether to clamp the sampling efforts at
a single value. Defaults to <code>TRUE</code>. If <code>TRUE</code>, the <code>Fix_Efforts</code> argument
must be provided.</p></dd>


<dt id="arg-fix-efforts">Fix_Efforts<a class="anchor" aria-label="anchor" href="#arg-fix-efforts"></a></dt>
<dd><p>Numeric or character. Defines the value to fix sampling
efforts less than the provided value. If numeric, the value is directly
used. If character, it can be <code>median</code>, <code>mean</code>, <code>max</code>, or <code>q90</code> (90%
Quantile). Using <code>max</code> can reflect extreme values caused by rare, highly
sampled locations (e.g., urban centers or popular natural reserves). While
using 90% Quantile avoid such extreme grid cells while still capturing
areas with high sampling effort. This argument is mandatory when
<code>Pred_Clamp</code> is set to <code>TRUE</code>.</p></dd>


<dt id="arg-pred-newsites">Pred_NewSites<a class="anchor" aria-label="anchor" href="#arg-pred-newsites"></a></dt>
<dd><p>Logical indicating whether to predict habitat
suitability at new sites. Default: <code>TRUE</code>. Note: This parameter is
temporary and will be removed in future updates.</p></dd>


<dt id="arg-ncores-vp">NCores_VP<a class="anchor" aria-label="anchor" href="#arg-ncores-vp"></a></dt>
<dd><p>Integer specifying the number of cores to use for variance
partitioning. Defaults to 3.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ahmed El-Gabbas</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://elgabbas.netlify.app/" class="external-link">Ahmed El-Gabbas</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

