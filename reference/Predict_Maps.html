<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Predict habitat suitability of Hmsc models — predict_maps • IASDT.R</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predict habitat suitability of Hmsc models — predict_maps"><meta name="description" content="This package provides two functions for predicting habitat suitability of
Hmsc models in the IASDT framework. predict_maps generates current and
future habitat suitability maps (mean, sd, cov) from a full Hmsc model fit.
predict_maps_CV predicts and evaluates cross-validated Hmsc models for
current climate conditions. For more details, see the respective function
documentation and the details section below."><meta property="og:description" content="This package provides two functions for predicting habitat suitability of
Hmsc models in the IASDT framework. predict_maps generates current and
future habitat suitability maps (mean, sd, cov) from a full Hmsc model fit.
predict_maps_CV predicts and evaluates cross-validated Hmsc models for
current climate conditions. For more details, see the respective function
documentation and the details section below."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IASDT.R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.08</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-modelling-workflow" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Modelling workflow</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-modelling-workflow"><li><a class="dropdown-item" href="../articles/workflow_1_overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/workflow_2_abiotic_data.html">Processing abiotic data</a></li>
    <li><a class="dropdown-item" href="../articles/workflow_3_biotic_data.html">Processing biotic data</a></li>
    <li><a class="dropdown-item" href="../articles/workflow_4_model_fitting.html">Model fitting</a></li>
    <li><a class="dropdown-item" href="../articles/workflow_5_model_postprocess.html">Model post-processing</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BioDT/IASDT.R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Predict habitat suitability of <code>Hmsc</code> models</h1>
      <small class="dont-index">Source: <a href="https://github.com/BioDT/IASDT.R/blob/main/R/mod_predict_maps.R" class="external-link"><code>R/mod_predict_maps.R</code></a>, <a href="https://github.com/BioDT/IASDT.R/blob/main/R/mod_predict_maps_CV.R" class="external-link"><code>R/mod_predict_maps_CV.R</code></a></small>
      <div class="d-none name"><code>Predict_Maps.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This package provides two functions for predicting habitat suitability of
<code>Hmsc</code> models in the <code>IASDT</code> framework. predict_maps generates current and
future habitat suitability maps (mean, sd, cov) from a full Hmsc model fit.
predict_maps_CV predicts and evaluates cross-validated Hmsc models for
current climate conditions. For more details, see the respective function
documentation and the details section below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predict_maps</span><span class="op">(</span></span>
<span>  path_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hab_abb <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  env_file <span class="op">=</span> <span class="st">".env"</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">8L</span>,</span>
<span>  strategy <span class="op">=</span> <span class="st">"multisession"</span>,</span>
<span>  clamp_pred <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fix_efforts <span class="op">=</span> <span class="st">"q90"</span>,</span>
<span>  fix_rivers <span class="op">=</span> <span class="st">"q90"</span>,</span>
<span>  pred_new_sites <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_TF <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  TF_environ <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  TF_use_single <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  LF_n_cores <span class="op">=</span> <span class="va">n_cores</span>,</span>
<span>  LF_check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  LF_temp_cleanup <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  LF_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  LF_commands_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  temp_dir <span class="op">=</span> <span class="st">"TEMP_Pred"</span>,</span>
<span>  temp_cleanup <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tar_predictions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  spatial_model <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  CC_models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GFDL-ESM4"</span>, <span class="st">"IPSL-CM6A-LR"</span>, <span class="st">"MPI-ESM1-2-HR"</span>, <span class="st">"MRI-ESM2-0"</span>,</span>
<span>    <span class="st">"UKESM1-0-LL"</span><span class="op">)</span>,</span>
<span>  CC_scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ssp126"</span>, <span class="st">"ssp370"</span>, <span class="st">"ssp585"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">predict_maps_CV</span><span class="op">(</span></span>
<span>  model_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  CV_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  CV_fold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">8L</span>,</span>
<span>  strategy <span class="op">=</span> <span class="st">"multisession"</span>,</span>
<span>  env_file <span class="op">=</span> <span class="st">".env"</span>,</span>
<span>  use_TF <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  TF_environ <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  TF_use_single <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  LF_n_cores <span class="op">=</span> <span class="va">n_cores</span>,</span>
<span>  LF_check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  LF_temp_cleanup <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  LF_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  LF_commands_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  temp_cleanup <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-path-model">path_model<a class="anchor" aria-label="anchor" href="#arg-path-model"></a></dt>
<dd><p>Character. Path to fitted <code>Hmsc</code> model object.</p></dd>


<dt id="arg-hab-abb">hab_abb<a class="anchor" aria-label="anchor" href="#arg-hab-abb"></a></dt>
<dd><p>Character. Habitat abbreviation indicating the specific
<a href="https://www.preslia.cz/article/pdf?id=11548" class="external-link">SynHab</a> habitat type. Valid
values: <code>0</code>, <code>1</code>, <code>2</code>, <code>3</code>, <code>4a</code>, <code>4b</code>, <code>10</code>, <code>12a</code>, <code>12b</code>. See <a href="https://doi.org/10.23855/preslia.2022.447" class="external-link">Pysek et al.</a> for details.</p></dd>


<dt id="arg-env-file">env_file<a class="anchor" aria-label="anchor" href="#arg-env-file"></a></dt>
<dd><p>Character. Path to the environment file containing paths to
data sources. Defaults to <code>.env</code>.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Integer. Number of CPU cores to use for parallel processing.
Default: 8.</p></dd>


<dt id="arg-strategy">strategy<a class="anchor" aria-label="anchor" href="#arg-strategy"></a></dt>
<dd><p>Character. The parallel processing strategy to use. Valid
options are "sequential", "multisession" (default), "multicore", and
"cluster". See <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a></code> and <code><a href="https://elgabbas.github.io/ecokit/reference/set_parallel.html" class="external-link">ecokit::set_parallel()</a></code> for details.</p></dd>


<dt id="arg-clamp-pred">clamp_pred<a class="anchor" aria-label="anchor" href="#arg-clamp-pred"></a></dt>
<dd><p>Logical indicating whether to clamp the sampling efforts at
a single value. If <code>TRUE</code> (default), the <code>fix_efforts</code> argument must be
provided.</p></dd>


<dt id="arg-fix-efforts">fix_efforts<a class="anchor" aria-label="anchor" href="#arg-fix-efforts"></a></dt>
<dd><p>Numeric or character. When <code>clamp_pred = TRUE</code>, fixes the
sampling efforts predictor at this value during predictions. If numeric,
uses the value directly (on log<sub>10</sub> scale). If character, must be
one of <code>identity</code> (i.e., do not fix), <code>median</code>, <code>mean</code>, <code>max</code>, or <code>q90</code>
(90% quantile). Using <code>max</code> may reflect extreme sampling efforts from
highly sampled locations, while <code>q90</code> captures high sampling areas without
extremes. Required if <code>clamp_pred = TRUE</code>.</p></dd>


<dt id="arg-fix-rivers">fix_rivers<a class="anchor" aria-label="anchor" href="#arg-fix-rivers"></a></dt>
<dd><p>Numeric, character, or <code>NULL</code>. Similar to <code>fix_efforts</code>,
but for the river length predictor. If <code>NULL</code>, the river length is not
fixed. Default: <code>q90</code>.</p></dd>


<dt id="arg-pred-new-sites">pred_new_sites<a class="anchor" aria-label="anchor" href="#arg-pred-new-sites"></a></dt>
<dd><p>Logical. Whether to predict suitability at new sites.
Default: <code>TRUE</code>.</p></dd>


<dt id="arg-use-tf">use_TF<a class="anchor" aria-label="anchor" href="#arg-use-tf"></a></dt>
<dd><p>Logical. Whether to use <code>TensorFlow</code> for calculations. Defaults
to <code>TRUE</code>.</p></dd>


<dt id="arg-tf-environ">TF_environ<a class="anchor" aria-label="anchor" href="#arg-tf-environ"></a></dt>
<dd><p>Character. Path to the Python environment. This argument is
required if <code>use_TF</code> is <code>TRUE</code> under Windows. Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-tf-use-single">TF_use_single<a class="anchor" aria-label="anchor" href="#arg-tf-use-single"></a></dt>
<dd><p>Logical. Whether to use single precision for the
<code>TensorFlow</code> calculations. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-lf-n-cores">LF_n_cores<a class="anchor" aria-label="anchor" href="#arg-lf-n-cores"></a></dt>
<dd><p>Integer. Number of cores to use for parallel processing of
latent factor prediction. Defaults to 8L.</p></dd>


<dt id="arg-lf-check">LF_check<a class="anchor" aria-label="anchor" href="#arg-lf-check"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the function checks if the output files
are already created and valid. If <code>FALSE</code>, the function will only check if
the files exist without checking their integrity. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-lf-temp-cleanup">LF_temp_cleanup<a class="anchor" aria-label="anchor" href="#arg-lf-temp-cleanup"></a></dt>
<dd><p>Logical. Whether to delete temporary files in the
<code>temp_dir</code> directory after finishing the LF predictions.</p></dd>


<dt id="arg-lf-only">LF_only<a class="anchor" aria-label="anchor" href="#arg-lf-only"></a></dt>
<dd><p>Logical. Whether to predict only the latent factor. This is
useful for distributing processing load between GPU and CPU. When <code>LF_only = TRUE</code>, latent factor prediction needs to be computed separately on GPU.
When computations are finished on GPU, the function can later be rerun with
<code>LF_only = FALSE</code> (default) to predict habitat suitability using the
already-computed latent factor predictions.</p></dd>


<dt id="arg-lf-commands-only">LF_commands_only<a class="anchor" aria-label="anchor" href="#arg-lf-commands-only"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, returns the command to run the
Python script. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-temp-dir">temp_dir<a class="anchor" aria-label="anchor" href="#arg-temp-dir"></a></dt>
<dd><p>Character. Path for temporary storage of intermediate files.</p></dd>


<dt id="arg-temp-cleanup">temp_cleanup<a class="anchor" aria-label="anchor" href="#arg-temp-cleanup"></a></dt>
<dd><p>Logical. Whether to clean up temporary files. Defaults to
<code>TRUE</code>.</p></dd>


<dt id="arg-tar-predictions">tar_predictions<a class="anchor" aria-label="anchor" href="#arg-tar-predictions"></a></dt>
<dd><p>Logical. Whether to compress the add files into a
single <code>*.tar</code> file (without compression). Default: <code>TRUE</code>.</p></dd>


<dt id="arg-spatial-model">spatial_model<a class="anchor" aria-label="anchor" href="#arg-spatial-model"></a></dt>
<dd><p>Logical. Whether the fitted model is a spatial model.
Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-cc-models">CC_models<a class="anchor" aria-label="anchor" href="#arg-cc-models"></a></dt>
<dd><p>Character vector. Climate models for future predictions.
Available options are <code>c("GFDL-ESM4", "IPSL-CM6A-LR", "MPI-ESM1-2-HR", "MRI-ESM2-0", "UKESM1-0-LL")</code> (default).</p></dd>


<dt id="arg-cc-scenario">CC_scenario<a class="anchor" aria-label="anchor" href="#arg-cc-scenario"></a></dt>
<dd><p>Character vector. Climate scenarios for future
predictions. Available options are: <code>c("ssp126", "ssp370", "ssp585")</code>
(default).</p></dd>


<dt id="arg-model-dir">model_dir<a class="anchor" aria-label="anchor" href="#arg-model-dir"></a></dt>
<dd><p>Character. Path to the directory containing cross-validated
models.</p></dd>


<dt id="arg-cv-name">CV_name<a class="anchor" aria-label="anchor" href="#arg-cv-name"></a></dt>
<dd><p>Character. Cross-validation strategy. Valid values are
<code>CV_Dist</code>, <code>CV_Large</code>, or <code>CV_SAC</code>.</p></dd>


<dt id="arg-cv-fold">CV_fold<a class="anchor" aria-label="anchor" href="#arg-cv-fold"></a></dt>
<dd><p>Integer. The cross-validation fold number.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p><strong><code>predict_maps</code></strong>: Generates habitat suitability maps for <code>Hmsc</code> models
fitted on the full dataset, for both current and future climate options. It
produces maps for mean, standard deviation (sd), and coefficient of variation
(cov) of suitability for each species and overall species richness. It
evaluate model's explanatory power using various metrics. For future
predictions, it also generates anomaly maps (future - current). The function
supports ensemble predictions across multiple climate models and prepares
data for upload to the <a href="http://opendap.biodt.eu/ias-pdt/" class="external-link">OPeNDAP</a> server for
use in the <code>IASDT</code> <a href="https://app.biodt.eu/" class="external-link">Shiny App</a>.</p></li>
<li><p><strong><code>predict_maps_CV</code></strong>: Computes predictions for cross-validated <code>Hmsc</code>
models using only the testing folds. It evaluates model performance
(predictive power) with various metrics and plots evaluation results for
predictive and explanatory power. Unlike <code>predict_maps</code>, this function does
not perform clamping and does not generate future climate predictions.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>predict_hmsc</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ahmed El-Gabbas</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://elgabbas.netlify.app/" class="external-link">Ahmed El-Gabbas</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

