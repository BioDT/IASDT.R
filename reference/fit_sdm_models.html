<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Species Distribution Modelling Workflow for Single-Species Models — fit_sdm_models • IASDT.R</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Species Distribution Modelling Workflow for Single-Species Models — fit_sdm_models"><meta name="description" content="This comprehensive workflow implements single-species species distribution
models (sSDMs) for invasive alien plant species in Europe at the habitat
level. It orchestrates the entire process from data preparation to model
fitting, evaluation, and prediction across current and future climate
scenarios. The workflow employs the sdm R package for model fitting and
handles cross-validation, parallel processing, and various environmental
predictors."><meta property="og:description" content="This comprehensive workflow implements single-species species distribution
models (sSDMs) for invasive alien plant species in Europe at the habitat
level. It orchestrates the entire process from data preparation to model
fitting, evaluation, and prediction across current and future climate
scenarios. The workflow employs the sdm R package for model fitting and
handles cross-validation, parallel processing, and various environmental
predictors."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IASDT.R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.08</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-modelling-workflow" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Modelling workflow</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-modelling-workflow"><li><a class="dropdown-item" href="../articles/workflow_1_overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/workflow_2_abiotic_data.html">Processing abiotic data</a></li>
    <li><a class="dropdown-item" href="../articles/workflow_3_biotic_data.html">Processing biotic data</a></li>
    <li><a class="dropdown-item" href="../articles/workflow_4_model_fitting.html">Model fitting</a></li>
    <li><a class="dropdown-item" href="../articles/workflow_5_model_postprocess.html">Model post-processing</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BioDT/IASDT.R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Species Distribution Modelling Workflow for Single-Species Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/BioDT/IASDT.R/blob/main/R/mod_ssdm_fit.R" class="external-link"><code>R/mod_ssdm_fit.R</code></a></small>
      <div class="d-none name"><code>fit_sdm_models.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This comprehensive workflow implements single-species species distribution
models (sSDMs) for invasive alien plant species in Europe at the habitat
level. It orchestrates the entire process from data preparation to model
fitting, evaluation, and prediction across current and future climate
scenarios. The workflow employs the <code>sdm</code> R package for model fitting and
handles cross-validation, parallel processing, and various environmental
predictors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_sdm_models</span><span class="op">(</span></span>
<span>  sdm_method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model_settings <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">8L</span>,</span>
<span>  model_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cv_type <span class="op">=</span> <span class="st">"CV_Dist"</span>,</span>
<span>  selected_species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  excluded_species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  env_file <span class="op">=</span> <span class="st">".env"</span>,</span>
<span>  hab_abb <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clamp_pred <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fix_efforts <span class="op">=</span> <span class="st">"q90"</span>,</span>
<span>  fix_rivers <span class="op">=</span> <span class="st">"q90"</span>,</span>
<span>  climate_models <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  climate_scenarios <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  climate_periods <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  copy_maxent_html <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  future_max_size <span class="op">=</span> <span class="fl">2000L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sdm-method">sdm_method<a class="anchor" aria-label="anchor" href="#arg-sdm-method"></a></dt>
<dd><p>Character. A single SDM algorithm to use for fitting
models. Valid values: "glm", "glmpoly", "gam", "glmnet", "mars", "gbm",
"rf", "ranger", "cart", "rpart", "maxent", "mlp", "rbf", "svm", "mda", and
"fda". These correspond to selected methods supported by the <code>sdm</code> package.
For details and supported options, see <code><a href="https://rdrr.io/pkg/sdm/man/add.html" class="external-link">sdm::getmethodNames()</a></code>.</p></dd>


<dt id="arg-model-settings">model_settings<a class="anchor" aria-label="anchor" href="#arg-model-settings"></a></dt>
<dd><p>List or NULL. List of model-specific settings. If
<code>NULL</code>, defaults to custom settings defined within the workflow.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Integer. Number of CPU cores for parallel processing. Default
is 8.</p></dd>


<dt id="arg-model-dir">model_dir<a class="anchor" aria-label="anchor" href="#arg-model-dir"></a></dt>
<dd><p>Character. Path to the directory containing model data and
where outputs and results will be saved. Model data are prepared using the
<code><a href="Mod_inputs.html">mod_prepare_HPC()</a></code> and <code><a href="Mod_inputs.html">mod_prepare_data()</a></code> functions.</p></dd>


<dt id="arg-cv-type">cv_type<a class="anchor" aria-label="anchor" href="#arg-cv-type"></a></dt>
<dd><p>Character. Cross-validation type. One of <code>CV_Dist</code> (default)
or <code>CV_Large</code>. See <code><a href="Mod_CV_Fit.html">mod_CV_fit()</a></code> for more details.</p></dd>


<dt id="arg-selected-species">selected_species<a class="anchor" aria-label="anchor" href="#arg-selected-species"></a></dt>
<dd><p>Character vector or NULL. Names of species to include
for modelling.</p></dd>


<dt id="arg-excluded-species">excluded_species<a class="anchor" aria-label="anchor" href="#arg-excluded-species"></a></dt>
<dd><p>Character vector or NULL. Names of species to exclude
from modelling.</p></dd>


<dt id="arg-env-file">env_file<a class="anchor" aria-label="anchor" href="#arg-env-file"></a></dt>
<dd><p>Character. Path to a file with environment variable
definitions for spatial datasets. Default is <code>".env"</code>.</p></dd>


<dt id="arg-hab-abb">hab_abb<a class="anchor" aria-label="anchor" href="#arg-hab-abb"></a></dt>
<dd><p>Character. Abbreviation for a single SynHab habitat type.
Valid values: "0", "1", "2", "3", "4a", "4b", "10", "12a", "12b". See
<code><a href="Mod_inputs.html">mod_prepare_HPC()</a></code> for more details.</p></dd>


<dt id="arg-clamp-pred">clamp_pred<a class="anchor" aria-label="anchor" href="#arg-clamp-pred"></a></dt>
<dd><p>Logical. Should clamping be applied to sampling efforts and
river length predictors for prediction? Default is <code>TRUE</code>.</p></dd>


<dt id="arg-fix-efforts">fix_efforts<a class="anchor" aria-label="anchor" href="#arg-fix-efforts"></a></dt>
<dd><p>Character or numeric (length 1). Method or fixed value for
sampling effort (log-scale) when clamping is enabled (<code>clamp_pred = TRUE</code>).
Valid methods: "identity" (use observed, with no clamping), summary
statistics for the sampling efforts layer ("median", "mean", "max", or
"q90" (default; 90th percentile)), or a single numeric value within
observed range. If using a numeric value, ensure it is within the range of
sampling effort layer.</p></dd>


<dt id="arg-fix-rivers">fix_rivers<a class="anchor" aria-label="anchor" href="#arg-fix-rivers"></a></dt>
<dd><p>Character or numeric (length 1). Method or fixed value for
river length (log-scale) when clamping is enabled (<code>clamp_pred = TRUE</code>).
Valid values are similar to <code>fix_efforts</code>.</p></dd>


<dt id="arg-climate-models">climate_models<a class="anchor" aria-label="anchor" href="#arg-climate-models"></a></dt>
<dd><p>Character vector or "all". Which climate change models
to use for future projections. Valid values (case-sensitive): "GFDL-ESM4",
"IPSL-CM6A-LR", "MPI-ESM1-2-HR", "MRI-ESM2-0", "UKESM1-0-LL", or "all"
(default, meaning all available models). If a subset, must be a subset of
the listed valid models.</p></dd>


<dt id="arg-climate-scenarios">climate_scenarios<a class="anchor" aria-label="anchor" href="#arg-climate-scenarios"></a></dt>
<dd><p>Character vector or "all". Which climate change
scenarios to use for future projections. Valid values: "ssp126", "ssp370",
"ssp585", or "all" (default, meaning all available scenarios). If a subset,
must be a subset of the listed valid scenarios.</p></dd>


<dt id="arg-climate-periods">climate_periods<a class="anchor" aria-label="anchor" href="#arg-climate-periods"></a></dt>
<dd><p>Character vector or "all". Time periods for
prediction. Valid values are "2011-2040", "2041-2070", "2071-2100", or
"all" (default), or subset of supported periods.</p></dd>


<dt id="arg-copy-maxent-html">copy_maxent_html<a class="anchor" aria-label="anchor" href="#arg-copy-maxent-html"></a></dt>
<dd><p>Logical. Whether to copy the directory containing
HTML results from Maxent to the modelling directory. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-future-max-size">future_max_size<a class="anchor" aria-label="anchor" href="#arg-future-max-size"></a></dt>
<dd><p>Numeric. Maximum allowed total size (in megabytes) of
global variables identified. See <code>set_parallel()</code> and
<code>future.globals.maxSize</code> argument of <code><a href="https://future.futureverse.org/reference/zzz-future.options.html" class="external-link">future::future.options()</a></code> for more
details. Default is 2000L for 2 GB. No upper limit is enforced by this
function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble summarizing model results for each species, including:</p><ul><li><p>Evaluation metrics for training and testing data (AUC, TSS, Kappa, etc.)</p></li>
<li><p>Variable importance scores</p></li>
<li><p>Response curves for each environmental variable</p></li>
<li><p>Prediction summaries for current and future climate scenarios</p></li>
<li><p>Paths to generated model files and prediction rasters</p></li>
</ul><p>Additionally, the function saves various outputs to disk for future use:</p><ul><li><p>Fitted model objects (as .RData files)</p></li>
<li><p>Extracted model information (evaluation metrics, variable importance,
etc.)</p></li>
<li><p>Prediction rasters for each species, cross-validation fold, and climate
scenario</p></li>
<li><p>Summary statistics across CV folds (mean, weighted mean, SD, and
coefficient of variation)</p></li>
<li><p>Species richness maps for each climate scenario</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>fit_sdm_models</code> function orchestrates a comprehensive workflow
that handles all aspects of single-species distribution modelling for
invasive alien plant species in Europe. The workflow integrates several
internal components that manage different stages of the modelling process:</p>
<p><strong>Overall workflow:</strong></p><ul><li><p><em>Input validation</em>: Checks all parameters for validity</p></li>
<li><p><em>Data preparation</em>: Loads and processes model data</p></li>
<li><p><em>Parallel processing setup</em>: Configures computational resources</p></li>
<li><p><em>Model fitting and prediction</em>: For each species and CV fold</p></li>
<li><p><em>Results summarization</em>: Compiles metrics, variable importance, and
predictions</p></li>
<li><p><em>Species richness calculation</em>: Across all modelled species</p></li>
</ul><p><strong>Core capabilities:</strong></p><ul><li><p><em>Data preparation</em>: The workflow validates and prepares necessary
input data including modelling data, environmental predictors, and
prediction datasets. It handles species selection, data loading, and
preprocessing of spatial predictors (including clamping of sampling efforts
and river length when required).</p></li>
<li><p><em>Model parameterization</em>: The function provides carefully selected
default settings for various SDM algorithms, ensuring consistent
parameterization across models.</p></li>
<li><p><em>Model information extraction</em>: After fitting, the workflow
automatically extracts key information from fitted SDM objects, including
evaluation metrics, variable importance, and response curves.</p></li>
<li><p><em>Model optimization</em>: Technical improvements like optimizing SDM model
object size by setting formula environments to the base environment address
known issues in the sdm package.</p></li>
<li><p><em>Parallel prediction</em>: The workflow efficiently generates predictions
for each species and cross-validation fold, handling model fitting,
information extraction, prediction, and file saving in parallel.</p></li>
<li><p><em>Statistical summarization</em>: Summary statistics are calculated across
cross-validation folds, including mean, weighted mean (by test AUC),
standard deviation, and coefficient of variation of predictions.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ahmed El-Gabbas</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://elgabbas.netlify.app/" class="external-link">Ahmed El-Gabbas</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

